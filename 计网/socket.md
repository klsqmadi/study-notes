https://zhuanlan.zhihu.com/p/159272095

https://blog.csdn.net/luzhensmart/article/details/81838193

![img](https://img-blog.csdnimg.cn/20190718154523875.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3Bhc2hhbmh1NjQwMg==,size_16,color_FFFFFF,t_70)

TCP、UDP是在传输层的协议，可以简单理解成是一种约定，只有履行约定才是实质性的行动。

所以无论是TCP还是UDP要产生作用，都需要有实质性的行为去执行才能体现协议的作用，socket（**套接字**）就是实现这种作用的方法。

socket是为了方便使用TCP或者UDP而抽象出来的一层，是位于**应用层**和**传输层**之间的一组接口，复杂的TCP/IP协议族隐藏在socket接口后面，它把TCP/IP层复杂的操作抽象为几个简单的接口供应用层调用已实现进程在网络中通信。对用户来说，一组简单的接口就是全部，让socket去组织数据，以符合指定的协议。

当两台主机通信时，必须通过socket连接，**socket**则利用TCP/IP协议建立TCP连接，**TCP连接**则更依靠于底层的IP协议，I**P协议的连接**则依赖于链路层等更低层次



应用层通过传输层进行数据通信时，TCP和UDP会遇到同时为多个应用程序进程提供并发服务的问题。多个TCP连接或多个应用程序进程可能需要 通过**同一个TCP协议端口**传输数据。**为了区别不同的应用程序进程和连接**，许多计算机操作系统为应用程序与TCP／IP协议交互提供了称为套接字 (Socket)的接口，区分不同应用程序进程间的网络通信和连接。



Socket可以看成在两个程序进行通讯连接中的一个端点，一个程序将一段信息写入Socket中，该Socket将这段信息发送给另外一个Socket中，使这段信息能传送到其他程序中。



根据不同的底层协议，socket的实现是多样化的，这里只介绍TCP/IP协议族的内容，在这个协议族当中主要的socket类型为**流套接字**和**数据报套接字**

- **流套接字**将**TCP**作为其端对端协议，提供了一个可信赖的字节流服务
- **数据报套接字**使用**UDP**协议，提供数据打包发送服务

socket作为一个通信链的句柄（是一个是用来标识对象或者项目的标识符），它包含了网络通信必备的5种信息

1. 连接使用的协议
2. 本地主机的IP地址
3. 本地进程的协议端口
4. 远地主机的IP地址
5. 远地进程协议端口

要通过互联网进行通信，至少需要一对socket，一个运行于客户端，成为ClientSocket，另一个运行于服务端，成为serverSocket

服务器和客户端通过socket进行交互。服务器需要绑定本机的某个端口号上，客户端需要声明自己连接哪个地址的哪个端口，这样服务器和客户端就能连接了。

根据连接启动的方式以及本地socket要连接的目标，套接字之间的连接过程可以分为三个步骤：服务器监听，客户端请求，连接确认。

1. **服务器监听**：是服务器socket并不定位具体的客户端socket，而是处于等待连接的状态，实时监控网络状态
2. **客户端请求**：是指由客户端socket提出连接请求，要连接的目标是服务器socket。为此，客户端socket必须首先描述他要连接的服务器socket，指出服务器socket的地址和端口号，然后就向服务器soket提出连接请求
3. **连接确认**：是指服务器socket监听到或者说接收到客户端socket的连接请求，他就响应客户端socket的请求，建立一个新的线程，把服务器socket的描述发送给客户端，一旦客户端确认了此描述，连接就建立好了。而服务器socket继续处于监听状态，继续接收其他客户端socket的连接请求。





还未能理解的

https://zhuanlan.zhihu.com/p/108464904

**socket和http的区别**

**socket连接**：
socket不属于协议范畴，而是一个调用接口（API），是对TCP/IP协议的封装。实现服务器与客户端之间的物理连接，并进行数据传输。Socket处于网络协议的传输层，主要有TCP/UDP两个协议。
socket连接是**长连接**，理论上客户端和服务器端一旦建立起连接将不会主动断掉；但是由于各种环境因素可能会是连接断开，比如：服务器端或客户端主机宕机了、网络故障，或者两者之间长时间没有数据传输，网络防火墙可能会断开该连接以释放网络资源。所以当一个socket连接中没有数据的传输，那么为了维持连接需要发送心跳消息。
socket传输的数据可自定义，为字节级，数据量小，可以加密，数据安全性高，适合Client/Server之间信息实时交互。

**http连接**：
HTTP是基于TCP/IP协议的应用层协议，定义的是传输数据的内容的规范。
HTTP是基于请求-响应形式并且是**短连接**，即客户端向服务器端发送一次请求，服务器端响应后连接即会断掉。
HTTP是**无状态**的协议，针对其无状态特性，在实际应用中又需要有状态的形式，因此一般会通过session/cookie技术来解决此问题。
HTTP的传输速度慢，数据包大，数据传输安全性差，如实现实时交互，服务器性能压力大。

**socket和http的应用场景有哪些**

socket一般用于比较即时的通信和实时性较高的情况，比如推送，聊天，保持心跳长连接等；
http一般用于实时性要求不那么高的情况，比如信息反馈，图片上传，获取新闻信息等。

某些场合使用http不使用socket的原因是socket一旦连接上了，就一直保持连接，就会造成阻塞IO，与此相对的的，还有非阻塞IO。
阻塞IO是指客户端请求服务器端，服务器端进行处理后，返回值给客户端。但当客户端太多、同时并发请求的时候，服务器端处理不过来，就会卡，因此提出了非阻塞IO，客户端请求服务器端，服务器端有一些监听器负责接受请求，接受好了，就告诉客户端已经接受好了，处理完后把数据发给客户端。

> 阻塞和非阻塞关注的是程序在等待调用结果（消息，返回值）时的状态。
> 阻塞调用是指调用结果返回之前，当前线程会被挂起。调用线程只有在得到结果之后才会返回。
> 非阻塞调用指在不能立刻得到结果之前，该调用不会阻塞当前线程。