# 三次握手

1. 第一次握手：建立连接。客户端发送连接请求报文段，将`SYN`位置为1，`Sequence Number`为x；然后，客户端进入【`SYN_SEND`状态】，等待服务器的确认；
   
2. 第二次握手：服务器收到`SYN`报文段。服务器收到客户端的`SYN`报文段，需要对这个`SYN`报文段进行确认，设置`Acknowledgment Number`为x+1(`Sequence Number`+1)；同时，自己自己还要发送`SYN`请求信息，将`SYN`位置为1，`Sequence Number`为y；服务[器端将上述所有信息放到一个报文段（即SYN+ACK报文段）中，一并发送给客户端，此时服务器进入【`SYN_RECV`状态】；
   
3. 第三次握手：客户端收到服务器的`SYN+ACK`报文段。然后将`Acknowledgment Number`设置为y+1，向服务器发送`ACK`报文段，这个报文段发送完毕以后，客户端和服务器端都进入【`ESTABLISHED`状态】，完成TCP三次握手。
   

完成了三次握手，客户端和服务器端就可以开始传送数据。以上就是TCP三次握手的总体介绍。

# 四次挥手

当客户端和服务器通过三次握手建立了TCP连接以后，当数据传送完毕，肯定是要断开TCP连接的啊。那对于TCP的断开连接，这里就有了神秘的“四次分手”。

1. 第一次挥手：主机1（可以使客户端，也可以是服务器端），设置`Sequence Number`和`Acknowledgment Number`，向主机2发送一个`FIN`报文段；此时，主机1进入【`FIN_WAIT_1`状态】；这表示主机1没有数据要发送给主机2了；
   
2. 第二次挥手：主机2收到了主机1发送的FIN报文段，向主机1回一个`ACK`报文段，`Acknowledgment Number`为`Sequence Number`加1；主机1进入【`FIN_WAIT_2`状态】；主机2告诉主机1，我“同意”你的关闭请求，主机2进入【`CLOSE_WAIT`状态】；
   
3. 第三次挥手：主机2向主机1发送`FIN`报文段，请求关闭连接，同时主机2进入【`LAST_ACK`状态】；
   
4. 第四次挥手：主机1收到主机2发送的`FIN`报文段，向主机2发送`ACK`报文段，然后主机1进入【`TIME_WAIT`状态】；主机2收到主机1的`ACK`报文段以后，就关闭连接；此时，主机1等待2MSL后依然没有收到回复，则证明Server端已正常关闭，那好，主机1也可以关闭连接了。
   

https://blog.csdn.net/c_kite/article/details/79836930